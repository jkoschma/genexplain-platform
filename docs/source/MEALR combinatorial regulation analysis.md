# MEALR combinatorial regulation analysis
### Extract TRANSFAC(R) PWMs from combinatorial regulation analysis
This tool extracts TRANSFAC&#174; PWMs from a result table generated by the <a href="https://platform.genexplain.com/bioumlweb/#de=analyses/Methods/MEALR%20combinatorial%20regulation%20analysis/TRANSFAC(R)%20MEALR%20combinatorial%20regulation%20analysis"> MEALR combinatorial regulation analysis </a>.
The PWMs represent transcription factor binding specificities that constitute the combinatorial
module predicted by the MEALR model.

**Input parameters**

| Parameter | Description |
| --------- | ----------- |
| Input MEALR search table | Input table, a MEALR search result table |
| Probability cutoff | Probability cutoff |
| Accuracy cutoff | Model accuracy cutoff |
| Importance cutoff | Logistic regression coefficient cutoff |
| Output | Output table |

Probability and accuracy cutoffs select MEALR models from the input table based on the observed
match probability and the model accuracy on test data, respectively. The importance cutoff is
applied to the PWM feature coefficients of the MEALR model allowing to focus on more important
matrices by increasing the threshold.

**Output**

The output contains the TRANSFAC&#174; PWMs extracted from MEALR models according to specified
cutoffs. This table can further be applied in several analyses, e.g. to extract corresponding
transcription factors using the tool <a href=""></a> or to create a profile for binding site
predictions (<a href="https://test2.genexplain.com/bioumlweb/#de=analyses/Methods/Site%20analysis/Create%20profile%20from%20site%20model%20table">
Create profile from site model table</a>) with <a href="https://test2.genexplain.com/bioumlweb/#de=analyses/Methods/Site%20analysis/TRANSFAC(R)%20Match(TM)%20for%20tracks">MATCH<sup>TM</sup></a>.

| Output table column | Description |
| ------------------- | ----------- |
| Max. probability | Highest match probability of models from which PWM was extracted |
| Max. accuracy | Highest accuracy of a model from which PWM was extracted |
| Max. importance | Highest importance of PWM in extracted models |
| Avg. probability | Average match probability of models from which PWM was extracted |
| Avg. accuracy | Average accuracy of a model from which PWM was extracted |
| Avg. importance | Average importance of PWM in extracted models |
| Min. probability | Lowest match probability of models from which PWM was extracted |
| Min. accuracy | Lowest accuracy of a model from which PWM was extracted |
| Min. importance | Lowest importance of PWM in extracted models |
| Cell sources | Cell sources of extracted models |
| Tissue sources | Tissue sources of extracted models |
| Factors | Transcription factors targeted in experiments of extracted models |
| Model ids | Ids of models from which PWM was extracted |

**Example analysis**

<a href="https://platform.genexplain.com/bioumlweb/#de=analyses/Methods/MEALR%20combinatorial%20regulation%20analysis/Extract%20TRANSFAC(R)%20PWMs%20from%20combinatorial%20regulation%20analysis">Open</a> the tool in the user interface.

- Specify a result table of a MEALR search analysis ([Input example](https://platform.genexplain.com/bioumlweb/#de=data%2FExamples%2FCombinatorial+regulation+analysis+of+TAL1%2FData%2FTAL1+track+%28Combinatorial+regulatory+analysis%29%2FMEALR+predictions%2FMEALR+search+result)).
- Specify probability, accuracy and importance cutoffs
- Specify an output table. A result path is suggested automatically on the basis of specified input (<a href="https://platform.genexplain.com/bioumlweb/#de=data/Examples/Combinatorial%20regulation%20analysis%20of%20TAL1/Data/TAL1%20track%20(Combinatorial%20regulatory%20analysis)/MEALR%20PWMs">Example result</a>)

### TRANSFAC(R) MEALR combinatorial regulation analysis
This analysis applies combinatorial regulatory models (CRMs) based on the
<a href="#de=analyses/Methods/Site%20analysis/MEALR%20(tracks)">MEALR affinity score</a> &#91;<a href="#ref1">1</a>&#93;
to classify or scan sequences for occurrences of combinations of transcription factor binding sites
represented by TRANSFAC&#174; PWMs. The models are taken from the MEALR library whose training data
originate from the TRANSFAC&#174; collection of high-throughput sequencing experiments.

## Input parameters

| Parameter | Description |
| --------- | ----------- |
| Sequence track | Sequence track or collection to search |
| Sequence source | Sequence source associated with the sequence track. Either a custom or genomic sequence source |
| Cell sources | Focus on models from selected cell sources |
| Tissue sources | Focus on models from selected tissue sources |
| Classification mode | Classify entire sequence instead of scanning for hits |
| Scan mode | Scan mode, best hit or cutoff based |
| Step size | Step size for scanning mode |
| Probability cutoff | Cutoff for the probability that a sequence matches the model |
| Model accuracy cutoff | Select models with test set accuracy equal or better than the accuracy cutoff prior to search |
| Output folder | Output folder for analysis results |

## Classification and scan modes

The _Classification mode_ evaluates input sequences as a whole, whereas the _scan mode_ analyzes
sequence windows separated by the given _step size_ (sliding window). In scan mode, the _Best hit_
method reports the best scoring sequence window disregarding a cutoff and the _Cutoff_ method
reports the best non-overlapping windows satisfying the specified cutoff.

### Note

The _MEALR search_ applies sequence length limits. The minimal sequence length for _scan_ **and**
_classification_ modes is **50** base characters. The _classification_ mode supports sequences up to
**5000** base characters.
Ideally, input sequences for _classification_ mode should have lengths corresponding to genomic
regions typically observed in ChIP-seq studies like 500 - 1000 bases, whereas input sequences for
scanning should not be too short, e.g. &ge;300 bases. We recommend to take differences between
model length and sequence length, which are reported in the output table, into account in the
assessment of the reliability of predictions.

Cell and tissue sources can be selected to focus on a subset of CRMs which have been trained with
data from respective sources. Please note that selection of multiple cells and/or tissues gathers
all CRMs that are associated with any one of selected sources.

## Output

The output folder encompasses a table and sequence track with information about model hits.
The output table contains sequence start and end points of hits, model ids, match probabilities as
well as other values as described below. For input sequences derived from genomic regions &#40;instead
of imported as custom sequences&#41; the table includes in addition a sequence id generated for a
region as well as the genomic sequence id, start and end coordinates.

| Output table column | Description |
| ------------------- | ----------- |
| Sequence id | Sequence id of custom or genomic sequence |
| Interval site name | Sequence id constructed for genomic interval |
| Start | CRM region start (one-based) |
| End | CRM region end (one-based) |
| Model id | MEALR model id |
| Factor gene | Gene symbol of transcription factor analyzed in source experiment generating training data |
| Cell source | Cell source of training data |
| Tissue source | Tissue source of training data |
| Model accuracy | Test set accuracy of MEALR model |
| Model type | Type of MEALR model (LR: logistic regression, WLR: LR with weighting of CRM region positions) |
| Model length | Length of CRM region |
| Sequence length | Length of analyzed sequence |
| Score | CRM score |
| Probability | CRM probability |


## Example analysis

<a href="https://platform.genexplain.com/bioumlweb/#de=analyses/Methods/MEALR%20combinatorial%20regulation%20analysis/TRANSFAC(R)%20MEALR%20combinatorial%20regulation%20analysis">Open</a> the tool in the user interface.

- Specify sequence(s) to analyze. This should be a _track_ item with custom or genomic sequences ([Input example](https://platform.genexplain.com/bioumlweb/#de=data%2FExamples%2FCombinatorial+regulation+analysis+of+TAL1%2FData%2FTAL1+track)). A _sequence source_ is suggested automatically.
- Select cell and tissue sources for filtering. There are over 400 cell types and more than 50 tissues to choose from. Please note that
multiple selection causes all models from the library to be considered that are associated with any one of the selected cells or tissues.
- Choose _Classification mode_ if _scan mode_ is not desired
- If _scan mode_, specify a step size and select _Best hit_ or _Cutoff_ mode
- If _Cutoff_ mode, specify a cutoff for model hits
- Specify a model accuracy cutoff
- Specify an output folder for results. The folder can already exist or be newly created by the workflow (<a href="https://platform.genexplain.com/bioumlweb/#de=data/Examples/Combinatorial%20regulation%20analysis%20of%20TAL1/Data/TAL1%20track%20(Combinatorial%20regulatory%20analysis)">Example result folder</a>).

<ol>
  <li>
    <a id="ref1">Katie Lloyd, Stamatia Papoutsopoulou, Emily Smith, Philip Stegmaier, Francois Bergey, et al., The SysmedIBD Consortium;
    Using systems medicine to identify a therapeutic agent with potential for repurposing in inflammatory bowel disease.</a>
    <a href="https://doi.org/10.1242/dmm.044040">Dis Model Mech 1 November 2020; 13 (11): dmm044040.</a>
  </li>
</ol>




